# JSP

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>

</body>
</html>
```

**JSP**（全称**J**ava**S**erver **P**ages）是由[Sun Microsystems](https://baike.baidu.com/item/Sun Microsystems)公司主导创建的一种[动态网页技术](https://baike.baidu.com/item/动态网页技术/9415956)标准。JSP部署于网络服务器上，可以响应客户端发送的请求，并根据请求内容动态地生成[HTML](https://baike.baidu.com/item/HTML)、[XML](https://baike.baidu.com/item/XML)或其他格式文档的[Web](https://baike.baidu.com/item/Web)网页，然后返回给请求者。JSP技术以[Java](https://baike.baidu.com/item/Java)语言作为[脚本语言](https://baike.baidu.com/item/脚本语言)，为用户的[HTTP](https://baike.baidu.com/item/HTTP)请求提供服务，并能与服务器上的其它Java程序共同处理复杂的业务需求。

JSP将Java代码和特定变动内容嵌入到静态的页面中，实现以静态页面为模板，动态生成其中的部分内容。JSP引入了被称为“JSP动作”的XML标签，用来调用内建功能。另外，可以创建JSP标签库，然后像使用标准HTML或XML标签一样使用它们。标签库能增强功能和服务器性能，而且不受[跨平台](https://baike.baidu.com/item/跨平台)问题的限制。JSP文件在运行时会被其编译器转换成更原始的[Servlet](https://baike.baidu.com/item/Servlet)代码。JSP编译器可以把JSP文件编译成用Java代码写的Servlet，然后再由Java编译器来编译成能快速执行的二进制[机器码](https://baike.baidu.com/item/机器码)，也可以直接编译成二进制码。



**HTML 与 JSP 的区别**

* 只给用户提供静态的数据
* JSP页面中可以嵌入Java代码，给用户提供动态数据



## JSP 原理

**JSP 如何执行：**

* 代码没有任何改变

  ![image-20210819205641941](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819205641941.png)

* 服务器内部

  在Tomcat目录下有一个work目录，IDEA使用Tomcat会在IDEA的Tomcat中生成一个work目录

  ![image-20210819205833133](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819205833133.png)

  ![image-20210819210013491](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819210013491.png)

  ![image-20210819210105105](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819210105105.png)

  发现页面转变为Java程序



**浏览器向服务器发送请求，不管访问什么资源，其实都是在访问Servlet**

JSP最终都会被编译为一个Java文件

```jsp
<%--
  Created by IntelliJ IDEA.
  User: J-ADan
  Date: 2021/8/19
  Time: 20:50
  To change this template use File | Settings | File Templates.
--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>

</body>
</html>

```

```java
/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/9.0.21
 * Generated at: 2021-08-19 12:55:47 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class index_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.HashSet<>();
    _jspx_imports_packages.add("javax.servlet");
    _jspx_imports_packages.add("javax.servlet.http");
    _jspx_imports_packages.add("javax.servlet.jsp");
    _jspx_imports_classes = null;
  }

  private volatile javax.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public javax.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
      throws java.io.IOException, javax.servlet.ServletException {

    if (!javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      final java.lang.String _jspx_method = request.getMethod();
      if ("OPTIONS".equals(_jspx_method)) {
        response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
        return;
      }
      if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
        response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
        response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP 只允许 GET、POST 或 HEAD。Jasper 还允许 OPTIONS");
        return;
      }
    }

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\r\n");
      out.write("\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("    <title>Title</title>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}

```

![image-20210819213525483](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819213525483.png)





**JSP 本质上就是一个Servlet**



```java
  public void _jspInit() {
      // 初始化
  }

  public void _jspDestroy() {
      销毁
  }

  public void _jspService()throws java.io.IOException, javax.servlet.ServletException{
      // JSPService
  }
```

1. 判断请求

   ```java
    public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
         throws java.io.IOException, javax.servlet.ServletException {
   
       if (!javax.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
         final java.lang.String _jspx_method = request.getMethod();
         if ("OPTIONS".equals(_jspx_method)) {
           response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
           return;
         }
         if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
           response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
           response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP 只允许 GET、POST 或 HEAD。Jasper 还允许 OPTIONS");
           return;
         }
       }
   ```

2. 内置对象

   ```java
    final javax.servlet.jsp.PageContext pageContext; // 页面上下文
       javax.servlet.http.HttpSession session = null; // Session
       final javax.servlet.ServletContext application; // applicationContext
       final javax.servlet.ServletConfig config; // Config
       javax.servlet.jsp.JspWriter out = null; // out
       final java.lang.Object page = this; // page 当前页
       javax.servlet.jsp.JspWriter _jspx_out = null;
       javax.servlet.jsp.PageContext _jspx_page_context = null;
   ```

3. 输出页面前增加的代码

   ```java
   response.setContentType("text/html;charset=UTF-8"); // 设置响应的页面类型
   pageContext = _jspxFactory.getPageContext(this, request, response,
   null, true, 8192, true);
   _jspx_page_context = pageContext;
   application = pageContext.getServletContext();
   config = pageContext.getServletConfig();
   session = pageContext.getSession();
   out = pageContext.getOut();
   _jspx_out = out;
   ```

4. 以上这些对象在JSP中可以直接使用



![image-20210819215116900](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210819215116900.png)



```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>

<%
    String name = "username";
%>
<%=name%>

</body>
</html>
```



```java
out.write("\r\n");
      out.write("\r\n");
      out.write("<html>\r\n");
      out.write("<head>\r\n");
      out.write("    <title>Title</title>\r\n");
      out.write("</head>\r\n");
      out.write("<body>\r\n");
      out.write("\r\n");

    String name = "username";

      out.write('\r');
      out.write('\n');
      out.print(name);
      out.write("\r\n");
      out.write("\r\n");
      out.write("</body>\r\n");
      out.write("</html>\r\n");
```

Java代码会原封不动，而HTML代码则会转换为 out.write 输出



## JSP 的基础语法和指令

**需要导入的依赖：**

```xml
<!-- https://mvnrepository.com/artifact/javax.servlet.jsp.jstl/jstl-api -->        <dependency>            <groupId>javax.servlet.jsp.jstl</groupId>            <artifactId>jstl-api</artifactId>            <version>1.2</version>        </dependency>        <!-- https://mvnrepository.com/artifact/taglibs/standard -->        <dependency>            <groupId>taglibs</groupId>            <artifactId>standard</artifactId>            <version>1.1.2</version>        </dependency>        <!-- https://mvnrepository.com/artifact/javax.servlet/javax.servlet-api -->        <dependency>            <groupId>javax.servlet</groupId>            <artifactId>javax.servlet-api</artifactId>            <version>3.0.1</version>            <scope>provided</scope>        </dependency>        <!-- https://mvnrepository.com/artifact/javax.servlet.jsp/jsp-api -->        <dependency>            <groupId>javax.servlet.jsp</groupId>            <artifactId>jsp-api</artifactId>            <version>2.1</version>            <scope>provided</scope>        </dependency>
```



**任何语言都有自己的语法，JSP作为Java技术的一种应用，它拥有自己扩充的一些语法，Java所有的语法他都支持**



```jsp
<%--JSP表达式将程序的结果输出到客户端<%= 变量或者表达式%>--%><%= new java.util.Date()%>
```



```jsp
<%--JSP 脚本片段--%>
<%
int sum = 0;
    for (int i = 0; i < 100; i++) {
        sum = sum + i;
    }
    out.println("<h1>Sum:" + sum + "<h1>");
%>
```



```jsp
<%--脚本片段的再实现--%>
<%
int x = 10;
out.println(x);
%>
<p>这是一个JSP文档</p>
<%--因为JSP的实质是一个Java类，并且在同一个方法中，所以上面定义的变量下面不可以再定义--%>
<%
int y = 20;
out.println(y);
%>
```



```jsp
<%
    for (int i = 0; i < 5; i++) {
%>
<p>Hello,World</p>
<%
    }
%>
<%
    for (int i = 0; i < 5; i++) {
%>
<p>Hello,World <%=i%></p>
<%
    }
%>
```



### JSP 声明

```jsp
<%!static {    System.out.println("加载JSP");}private int globalvar = 0;public void test(){    System.out.println("测试");}%>
```

![image-20210820140923612](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210820140923612.png)

JSP声明：会被编译到JSP生成的Java的类中，其他的就会生成到_jspService方法中

**在JSP中，嵌入Java代码即可**

```jsp
JSP中Java代码片段<%%>JSP输出某个值<%=%>JSP全局定义<!%%>JSP的注释<%--%>HTML注释<!---->
```

**在客户端的网页源代码中，JSP的注释是不会被显示在源代码中的，但是HTML的注释会被显示在源代码中**



### JSP指令



**自定义错误页面**

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %><html><head>    <title>Title</title></head><body><img src="../img/500.png" alt="500"></body></html>
```

**通过web.xml配置错误跳转页面**

```xml
<error-page>    <error-code>404</error-code>    <location>/error/404.jsp</location></error-page><error-page>    <error-code>500</error-code>    <location>/error/500.jsp</location></error-page>
```

通过web.xml配置的错误转换页面，会自动识别从服务器端传来的错误信息，并转到响应的页面



```jsp
<%@include file=""%>
```

**包含，提取公共页面**

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %><html><head>    <title>Title</title></head><body><%@include file="/common/header.jsp"%><h1>我是主体</h1><%@include file="/common/footer.jsp"%><%--JSP标签--%><jsp:include page="/common/header.jsp"></jsp:include><h1>我是主体2</h1><jsp:include page="/common/footer.jsp"></jsp:include></body></html>
```

**两者的区别：即JSP指令与JSP标签：**

* JSP指令

  ![image-20210820165654271](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210820165654271.png)

  把三个页面合并为一个页面

* JSP标签

  ![image-20210820165737817](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210820165737817.png)

  ![image-20210820165805398](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210820165805398.png)

  引入其他的两个页面，实质上还是三个页面。



## JSP 9大内置对象

* **PageContext // 页面上下文**
* **Request**
* **Response**
* **Session**
* **ServletContext（Application）**
* **ServletConfig（Config）**
* **JspWriter（out）**
* **Object（page 当前页）**
* **Exception**



```java
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>
<%
    pageContext.setAttribute("name1","一号"); // 保存的数据仅在当前页面有效
    request.setAttribute("name2","二号"); // 保存的数据只在一次请求中有效，请求转发会携带这个数据
    session.setAttribute("name3","三号"); // 保存的数据只在一次会话中有效，从打开浏览器到关闭浏览器
    application.setAttribute("name4","四号"); // 保存的数据只在服务器中有效，从打开服务器到关闭服务器
%>

<%
    // pageContext取出，通过找寻的方式
    // 从底层到高层page、request、session、application
    String name1 = (String) pageContext.findAttribute("name1");
    String name2 = (String) pageContext.findAttribute("name2");
    String name3 = (String) pageContext.findAttribute("name3");
    String name4 = (String) pageContext.findAttribute("name4");
    String name5 = (String) pageContext.findAttribute("name5");
%>
<h1>取出的值为：</h1>
<p>${name1}</p>
<p>${name2}</p>
<p>${name3}</p>
<p>${name4}</p>
<p>${name5}</p>
<p><%=name5%></p>
</body>
</html>

```



![image-20210821094656992](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210821094656992.png)

```java
<%--  Created by IntelliJ IDEA.  User: J-ADan  Date: 2021/8/21  Time: 10:50  To change this template use File | Settings | File Templates.--%><%@ page contentType="text/html;charset=UTF-8" language="java" %><html><head>    <title>Title</title></head><body><%--scope:作用域public static final int PAGE_SCOPE = 1;    public static final int REQUEST_SCOPE = 2;    public static final int SESSION_SCOPE = 3;    public static final int APPLICATION_SCOPE = 4;public void setAttribute(String name, Object attribute, int scope) {        switch(scope) {        case 1:            this.mPage.put(name, attribute);            break;        case 2:            this.mRequest.put(name, attribute);            break;        case 3:            this.mSession.put(name, attribute);            break;        case 4:            this.mApp.put(name, attribute);            break;        default:            throw new IllegalArgumentException("Bad scope " + scope);        }    }--%><%    // 作用域转变为Session的作用域    pageContext.setAttribute("name6","六号",pageContext.SESSION_SCOPE);%></body></html>
```



## EL 表达式

EL表达式：${}

* 获取数据
* 执行运算
* 获取Web开发常用的对象
* 调用Java的方法（一般不使用）



## JSP 标签

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>
<h1>index06</h1>
<jsp:forward page="index07.jsp">
    <jsp:param name="name" value="姜富超"/>
    <jsp:param name="age" value="18"/>
</jsp:forward>

</body>
</html>
```

相当于form表单的get，即请求



## JSTL 标签

JSP标准标签库（JSTL）是一个JSP标签集合，它封装了JSP应用的通用核心功能。

JSTL支持通用的、结构化的任务，比如迭代，条件判断，XML文档操作，国际化标签，SQL标签。 除了这些，它还提供了一个框架来使用集成JSTL的自定义标签。

根据JSTL标签所提供的功能，可以将其分为5个类别。

- **核心标签**
- **格式化标签**
- **SQL 标签**
- **XML 标签**
- **JSTL 函数**

JSTL标签库弥补了HTML标签的不足，他自定义了许多的标签，可以供我们使用，标签的功能和Java代码一致。



**核心标签（掌握部分）**

```jsp
<%--引入JSTL核心的标签库，我们才能够使用JSTL标签--%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
```

|      标签       |                             描述                             |
| :-------------: | :----------------------------------------------------------: |
|    < c:out >    |              用于在JSP中显示数据，就像<%= ... >              |
|    < c:set >    |                         用于保存数据                         |
|  < c:remove >   |                         用于删除数据                         |
|   < c:catch >   |      用来处理产生错误的异常状况，并且将错误信息储存起来      |
|    < c:if >     |                 与我们在一般程序中用的if一样                 |
|  < c:choose >   |        本身只当做< c:when >和< c:otherwise >的父标签         |
|   < c:when >    |          < c:choose >的子标签，用来判断条件是否成立          |
| < c:otherwise > | < c:choose >的子标签，接在< c:when >标签后，当< c:when >标签判断为false时被执行 |
|  < c:import >   |        检索一个绝对或相对 URL，然后将其内容暴露给页面        |
|  < c:forEach >  |                基础迭代标签，接受多种集合类型                |
| < c:forTokens > |             根据指定的分隔符来分隔内容并迭代输出             |
|   < c:param >   |               用来给包含或重定向的页面传递参数               |
| < c:redirect >  |                     重定向至一个新的URL.                     |
|    < c:url >    |               使用可选的查询参数来创造一个URL                |



![image-20210821114538050](C:\Users\J-ADan\AppData\Roaming\Typora\typora-user-images\image-20210821114538050.png)



```jsp

<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%--引入JSTL核心的标签库，我们才能够使用JSTL标签--%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Title</title>
</head>
<body>

<%--if 测试--%>

<h1>if</h1>
<form action="index09.jsp" method="get">
    <input type="text" name="username" value="username">
    <input type="submit" value="登录">
</form>
</body>
</html>

```

```jsp
<h1>${param.username}</h1>

<c:if test="${param.username == 'admin'}" var="isAdmin">
    <c:out value="管理员登陆成功"></c:out>
</c:if>
<c:out value="${isAdmin}"></c:out>
```



```jsp
<c:set var="test" value="95">
</c:set>

<c:choose>
    <c:when test="${test >= 90}">
        <c:out value="你的成绩为优秀"></c:out>
    </c:when>
    <c:when test="${test >= 80}">你的成绩为良好</c:when>
    <c:when test="${test >= 70}">你的成绩为一般</c:when>
    <c:when test="${test >= 60}">你的成绩为及格</c:when>
    <c:when test="${test < 60}">你的成绩为不及格</c:when>
</c:choose>
```



```jsp
<%
    ArrayList<String> arrayList = new ArrayList<>();
    arrayList.add("张三");
    arrayList.add("李四");
    arrayList.add("王五");
    arrayList.add("赵六");
    request.setAttribute("list",arrayList);
%>

<%--
var:每一次遍历的对象
items:要遍历的对象
begin:从哪里开始
end:到什么地方停下
step:步长
--%>

<c:forEach var="name" items="${list}">
    <c:out value="${name}"></c:out>
```





**格式化标签**

```jsp
<%@ taglib prefix="fmt" 
           uri="http://java.sun.com/jsp/jstl/fmt" %>
```



| 标签                    | 描述                                     |
| :---------------------- | :--------------------------------------- |
| < fmt:formatNumber >    | 使用指定的格式或精度格式化数字           |
| < fmt:parseNumber >     | 解析一个代表着数字，货币或百分比的字符串 |
| < fmt:formatDate >      | 使用指定的风格或模式格式化日期和时间     |
| < fmt:parseDate >       | 解析一个代表着日期或时间的字符串         |
| < fmt:bundle >          | 绑定资源                                 |
| < fmt:setLocale >       | 指定地区                                 |
| < fmt:setBundle >       | 绑定资源                                 |
| < fmt:timeZone >        | 指定时区                                 |
| < fmt:setTimeZone >     | 指定时区                                 |
| < fmt:message >         | 显示资源配置文件信息                     |
| < fmt:requestEncoding > | 设置request的字符编码                    |



**SQL标签**

```jsp
<%@ taglib prefix="sql" 
           uri="http://java.sun.com/jsp/jstl/sql" %>
```

| 标签                  | 描述                                                         |
| :-------------------- | :----------------------------------------------------------- |
| < sql:setDataSource > | 指定数据源                                                   |
| < sql:query >         | 运行SQL查询语句                                              |
| < sql:update >        | 运行SQL更新语句                                              |
| < sql:param >         | 将SQL语句中的参数设为指定值                                  |
| < sql:dateParam >     | 将SQL语句中的日期参数设为指定的java.util.Date 对象值         |
| < sql:transaction >   | 在共享数据库连接中提供嵌套的数据库行为元素，将所有语句以一个事务的形式来运行 |



**XML标签**

```jsp
<%@ taglib prefix="x" 
           uri="http://java.sun.com/jsp/jstl/xml" %>
```

在使用xml标签前，你必须将XML 和 XPath 的相关包拷贝至你的<Tomcat 安装目录>\lib下:

- XercesImpl.jar

  下载地址： http://www.apache.org/dist/xerces/j/

- xalan.jar

  下载地址： http://xml.apache.org/xalan-j/index.html



| 标签            | 描述                                                      |
| :-------------- | :-------------------------------------------------------- |
| < x:out >       | 与<%= ... >,类似，不过只用于XPath表达式                   |
| < x:parse >     | 解析 XML 数据                                             |
| < x:set >       | 设置XPath表达式                                           |
| < x:if >        | 判断XPath表达式，若为真，则执行本体中的内容，否则跳过本体 |
| < x:forEach >   | 迭代XML文档中的节点                                       |
| < x:choose >    | < x:when >和< x:otherwise >的父标签                       |
| < x:when >      | < x:choose >的子标签，用来进行条件判断                    |
| < x:otherwise > | < x:choose >的子标签，当< x:when >判断为false时被执行     |
| < x:transform > | 将XSL转换应用在XML文档中                                  |
| < x:param >     | 与< x:transform >共同使用，用于设置XSL样式表              |



**JSTL 函数**

```jsp
<%@ taglib prefix="fn" 
           uri="http://java.sun.com/jsp/jstl/functions" %>
```



| 函数                    | 描述                                                     |
| :---------------------- | :------------------------------------------------------- |
| fn:contains()           | 测试输入的字符串是否包含指定的子串                       |
| fn:containsIgnoreCase() | 测试输入的字符串是否包含指定的子串，大小写不敏感         |
| fn:endsWith()           | 测试输入的字符串是否以指定的后缀结尾                     |
| fn:escapeXml()          | 跳过可以作为XML标记的字符                                |
| fn:indexOf()            | 返回指定字符串在输入字符串中出现的位置                   |
| fn:join()               | 将数组中的元素合成一个字符串然后输出                     |
| fn:length()             | 返回字符串长度                                           |
| fn:replace()            | 将输入字符串中指定的位置替换为指定的字符串然后返回       |
| fn:split()              | 将字符串用指定的分隔符分隔然后组成一个子字符串数组并返回 |
| fn:startsWith()         | 测试输入字符串是否以指定的前缀开始                       |
| fn:substring()          | 返回字符串的子集                                         |
| fn:substringAfter()     | 返回字符串在指定子串之后的子集                           |
| fn:substringBefore()    | 返回字符串在指定子串之前的子集                           |
| fn:toLowerCase()        | 将字符串中的字符转为小写                                 |
| fn:toUpperCase()        | 将字符串中的字符转为大写                                 |
| fn:trim()               | 移除首尾的空白符                                         |



